{% set stats_title = stats_title | default('Статистика') %}
{% set stats_data = stats_data | default([]) %}
{% set stats_form_class = stats_form_class | default('form') %}
{% set stats_empty_message = stats_empty_message | default('Данные не найдены.') %}

<div class="card">
    <h3>{{ stats_title }}</h3>
    <div class="stats-table">
        {% if stats_data %}
            <table class="word-stats">
                <thead>
                    <tr>
                        <th>Строка</th>
                        <th>Количество</th>
                        <th>Найденные формы (кол-во)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for stat_item in stats_data %}
                        <tr>
                            <td>{{ stat_item['search']['text'] }}</td>
                            <td>{{ stat_item['total'] }}</td>
                            <td>
                                {% for form_key, form_item in stat_item['forms'].items() %}
                                    <span class="{{ stats_form_class }}">
                                        {{ form_item['form'] }} ({{ form_item['count'] }})

                                        {% if form_item['pages'] %}
                                            (стр. {{ form_item['pages'] | join(', ') }})
                                        {% endif %}
                                    </span>
                                    {% if not loop.last %}, {% endif %}
                                {% endfor %}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p class="note">{{ stats_empty_message }}</p>
        {% endif %}
    </div>
</div>
